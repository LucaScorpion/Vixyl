(this.webpackJsonpvixyl=this.webpackJsonpvixyl||[]).push([[0],{107:function(e,t,a){e.exports=a.p+"static/media/tweet.a7ac1566.png"},108:function(e,t,a){e.exports=a.p+"static/media/tdfw_new.6b381db3.png"},111:function(e,t,a){e.exports=a(285)},116:function(e,t,a){},285:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(106),i=a.n(c),o=(a(116),a(14)),l=a.n(o),u=a(23),s=a(6),d=a(19),h=a(20);function m(e,t){return e.x===t.x&&e.y===t.y}var f=function(){function e(t){Object(d.a)(this,e),this.imageData=void 0,this.imageData=t.getImageData(0,0,t.canvas.width,t.canvas.height)}return Object(h.a)(e,[{key:"getPixel",value:function(e,t){var a,n,r;"object"===typeof(r=e)&&r&&"x"in r&&"y"in r&&"number"===typeof r.x&&"number"===typeof r.y?(a=e.x,n=e.y):(a=e,n=t||0);var c=4*(a+n*this.imageData.width),i=this.imageData.data.slice(c,c+4);return{red:i[0],green:i[1],blue:i[2],alpha:i[3]}}},{key:"isInBounds",value:function(e){return e.x>=0&&e.y>=0&&e.x<this.imageData.width&&e.y<this.imageData.height}},{key:"width",get:function(){return this.imageData.width}},{key:"height",get:function(){return this.imageData.height}}]),e}(),v=function(e){var t=e.icon,a=e.className;return r.a.createElement("i",{className:"fas fa-".concat(t," ").concat(a||"")})};function g(e,t){return"data:".concat(e,";base64,").concat(function(e){for(var t,a="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(e),c=r.byteLength,i=c%3,o=c-i,l=0;l<o;l+=3)a+=n[(16515072&(t=r[l]<<16|r[l+1]<<8|r[l+2]))>>18]+n[(258048&t)>>12]+n[(4032&t)>>6]+n[63&t];return 1==i?a+=n[(252&(t=r[o]))>>2]+n[(3&t)<<4]+"==":2==i&&(a+=n[(64512&(t=r[o]<<8|r[o+1]))>>10]+n[(1008&t)>>4]+n[(15&t)<<2]+"="),a}(t))}var b=function(e){var t=e.type,a=g(t,e.data);return 0===t.indexOf("audio/")?r.a.createElement("audio",{controls:!0,src:a,style:{width:"100%"}}):0===t.indexOf("image/")?r.a.createElement("img",{src:a,alt:""}):r.a.createElement("a",{download:"file",href:a},r.a.createElement("button",{className:"big"},"Download ",r.a.createElement(v,{icon:"download"})))},y=a(24),p=a(45),E=a(44),w=a(68);function x(e){return{red:e,green:e,blue:e,alpha:255}}function j(e){return{red:255&e,green:e>>8&255,blue:e>>16&255,alpha:255}}function O(e){return e.red+(e.green<<8)+(e.blue<<16)}function k(e,t,a,n){e.fillStyle="rgba(".concat(n.red,", ").concat(n.green,", ").concat(n.blue,", ").concat(n.alpha,")"),e.fillRect(t,a,1,1)}function N(e,t,a,n,r){e.fillStyle=r,e.beginPath(),e.arc(t,a,n,0,2*Math.PI),e.fill()}var S,R,I=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,[{key:"getEncodeForm",value:function(){return[{key:"addQr",type:"boolean",text:"Add QR code",defaultValue:!0},{key:"bgColor",type:"color",text:"Background color",defaultValue:{r:0,g:0,b:0}}]}},{key:"encode",value:function(){var e=Object(u.a)(l.a.mark((function e(t,a){var n,r,c,i,o,u,s,d,h,m,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[j(t.type.length)].concat(Object(w.a)(t.type.split("").map((function(e){return x(e.charCodeAt(0))}))),[j(t.data.length)],Object(w.a)(this.getPixels(t.data))),r=this.createSpiral(n.length),c=2*r.radius+10,e.next=5,a.setCanvasProps({width:c,height:c});case 5:if((i=e.sent).clearRect(0,0,i.canvas.width,i.canvas.height),o={x:Math.round(i.canvas.width/2),y:Math.round(i.canvas.height/2)},u=a.form.bgColor,s=Math.min(null==u.a?1:u.a,.99),N(i,o.x,o.y,c/2,"rgba(".concat(u.r,", ").concat(u.g,", ").concat(u.b,", ").concat(s,")")),N(i,o.x,o.y,r.points[r.points.length-1].x-5,"white"),!a.form.addQr){e.next=16;break}return d=new Image,e.next=16,new Promise((function(e){d.addEventListener("load",(function(){i.drawImage(d,Math.round(o.x-d.width/2),Math.round(o.y-d.height/2)),e()})),d.src="/vixyl/qr.png"}));case 16:for(h=0;h<r.points.length;h++)m=r.points[h],k(i,m.x+o.x,m.y+o.y,n[h]);f=r.points[0],k(i,0,1,j(f.x+o.x)),k(i,1,1,j(f.y+o.y));case 20:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"decode",value:function(e){for(var t={x:O(e.getPixel(0,1)),y:O(e.getPixel(1,1))},a=this.readVinylTrack(e,t),n=O(a[0]),r="",c=0;c<n;c++)r="".concat(r).concat(String.fromCharCode(a[c+1].red));var i=O(a[n+1]);return{type:r,data:this.getBytes(a.slice(n+2)).slice(0,i)}}},{key:"createSpiral",value:function(e){var t,a=[],n=0,r=.1,c=30*Math.PI,i=this;function o(e){return!t||(m(e,t)?(r*=1.5,!1):!!i.isNeighbor(e,t)||(r/=2,!1))}for(var l=0;l<e;l++){for(var u=!1,s={x:0,y:0};!u;)u=o(s={x:Math.floor(.5*c*Math.cos(c+r)),y:Math.floor(.5*c*Math.sin(c+r))});l>1&&this.isNeighbor(a[l-2],s)&&delete a[l--];var d=Math.abs(s.x);d>n&&(n=d);var h=Math.abs(s.y);h>n&&(n=h),a[l]=s,t=s,c+=r}return{points:a.reverse(),radius:n}}},{key:"isNeighbor",value:function(e,t){return Math.abs(e.x-t.x)<=1&&Math.abs(e.y-t.y)<=1}},{key:"readVinylTrack",value:function(e,t){for(var a=[],n=t,r=t;r;){var c=e.getPixel(r);a.push(c);var i=this.findNextPixel(e,n,r);n=r,r=i}return a}},{key:"findNextPixel",value:function(e,t,a){for(var n=-1;n<=1;n++)for(var r=-1;r<=1;r++){var c={x:a.x+n,y:a.y+r};if(!m(c,t)&&!m(c,a)&&e.isInBounds(c)){var i=e.getPixel(c);if(255===i.alpha)return c}}return null}}]),e}(),C=function(e){Object(p.a)(a,e);var t=Object(E.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"getPixels",value:function(e){for(var t=[],a=0;a<e.length;a+=3)t.push({red:e[a],green:e[a+1]||0,blue:e[a+2]||0,alpha:255});return t}},{key:"getBytes",value:function(e){for(var t=new Uint8Array(3*e.length),a=0;a<e.length;a++){var n=e[a];t[3*a]=n.red,t[3*a+1]=n.green,t[3*a+2]=n.blue}return t}}]),a}(I),A=function(e){Object(p.a)(a,e);var t=Object(E.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"getPixels",value:function(e){var t=[];return e.forEach((function(e){return t.push(x(e))})),t}},{key:"getBytes",value:function(e){return new Uint8Array(e.map((function(e){return e.red})))}}]),a}(I);!function(e){e[e.GRAY_SPIRAL=0]="GRAY_SPIRAL",e[e.RAINBOW_SPIRAL=1]="RAINBOW_SPIRAL"}(R||(R={}));var P=(S={},Object(y.a)(S,R.GRAY_SPIRAL,A),Object(y.a)(S,R.RAINBOW_SPIRAL,C),S);function L(e){var t=P[e];if(!t)throw new Error("Unknown encoding");return new t}function M(e){var t=e.getPixel(0,0),a=e.getPixel(1,0);if(86!==t.red||105!==t.green||120!==t.blue||121!==a.red||108!==a.green)throw new Error("Invalid header");return L(a.blue)}var B=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(""),a=Object(s.a)(t,2),c=a[0],i=a[1],o=Object(n.useState)(),d=Object(s.a)(o,2),h=d[0],m=d[1],g=Object(n.useState)(),y=Object(s.a)(g,2),p=y[0],E=y[1],w=Object(n.useState)(),x=Object(s.a)(w,2),j=x[0],O=x[1],k=Object(n.useState)(!1),N=Object(s.a)(k,2),S=N[0],R=N[1];Object(n.useEffect)((function(){var e=new Image;e.addEventListener("load",(function(){m(e)})),e.src=c}),[c]),Object(n.useEffect)((function(){var t,a=null===(t=e.current)||void 0===t?void 0:t.getContext("2d");h&&a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.drawImage(h,0,0),E(new f(a)))}),[h]);var I=Object(n.useCallback)((function(e){var t,a=null===(t=e.currentTarget.files)||void 0===t?void 0:t.item(0);if(a){O(void 0);var n=new FileReader;n.addEventListener("load",(function(){"string"===typeof n.result&&i(n.result)})),n.readAsDataURL(a)}}),[]),C=Object(n.useCallback)(Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}return e.abrupt("return");case 2:if(O(void 0),t=M(p)){e.next=6;break}return e.abrupt("return");case 6:return R(!0),e.t0=O,e.next=10,t.decode(p);case 10:e.t1=e.sent,(0,e.t0)(e.t1),R(!1);case 13:case"end":return e.stop()}}),e)}))),[p]);return r.a.createElement("main",{className:"flex-center"},r.a.createElement("div",{className:"controls wide"},r.a.createElement("input",{type:"file",accept:"image/*",onChange:I,className:"row"}),r.a.createElement("div",{className:"center"},r.a.createElement("canvas",{ref:e,className:"row",width:null===h||void 0===h?void 0:h.width,height:null===h||void 0===h?void 0:h.height,style:{maxWidth:null===h||void 0===h?void 0:h.width,maxHeight:null===h||void 0===h?void 0:h.height}})),r.a.createElement("button",{className:"big",style:{marginBottom:12},onClick:C,disabled:!p},"Read ",r.a.createElement(v,{icon:"music"})),S&&r.a.createElement("div",{className:"big"},r.a.createElement(v,{icon:"spinner",className:"fa-pulse"})," Loading..."),r.a.createElement("div",{className:"center"},j&&r.a.createElement(b,{type:j.type,data:j.data}))))},D=function(){return r.a.createElement("a",{className:"github-corner",href:"https://github.com/LucaScorpion/vixyl",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:80,height:80,viewBox:"0 0 250 250",fill:"#EEE"},r.a.createElement("path",{d:"M0 0l115 115h15l12 27 108 108V0z",fill:"#222"}),r.a.createElement("path",{className:"octo-arm",d:"M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16"}),r.a.createElement("path",{className:"octo-body",d:"M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z"})))},T=a(17),V=a(3),W=function(e){var t=e.href,a=e.children;return r.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},a)},F=a(107),_=a.n(F),G=a(108),U=a.n(G),Y=function(){return r.a.createElement("main",{style:{maxWidth:900}},r.a.createElement("h3",null,"Vixyl lets you read and create pixel art vinyls."),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,r.a.createElement("p",null,"This project started thanks to a ",r.a.createElement(W,{href:"https://twitter.com/notch/status/490927655806853120"},"tweet by Notch"),"."),r.a.createElement("p",null,'Encoded in the spiral is an 8-bit mono 4kHz audio track, containing 3 seconds of the song "Turn Down for What". When I initially saw this I hacked together a tool in C# with Windows Forms that would allow you to read the image, and later I even added support for creating your own vinyls from a sound file.'),r.a.createElement("p",null,"Then, a few years later, I came across it again and figured it would be fun to completely redo the project with some major improvements, primarily making it browser-based so anyone can easily use it. A couple of coding sessions and a whole bunch of scope creep later, Vixyl was born!")),r.a.createElement("div",{style:{marginLeft:64}},r.a.createElement("img",{src:_.a,alt:"Notch's tweet",style:{width:260}}))),r.a.createElement("p",null,"Vixyl implements the idea of encoding binary data into an image in a more generic way. That means you can use it to encode any file into a vinyl. That does mean that the original image doesn't work with Vixyl, but I did make an updated version that does:"),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",{style:{marginRight:64}},r.a.createElement("img",{src:U.a,alt:"Turn Down For What vinyl"})),r.a.createElement("div",null,r.a.createElement("p",null,"Try it out for yourself! Go to ",r.a.createElement(T.b,{to:"/read"},"Read vinyl")," to try reading this image, or go to ",r.a.createElement(T.b,{to:"/create"},"Create vinyl")," to create your own vinyl from a song, image, or any other file."))),r.a.createElement("h3",null,"Source code, issues, or contributing?"),r.a.createElement("p",null,"This project is completely open source and available ",r.a.createElement(W,{href:"https://github.com/LucaScorpion/vixyl"},"on GitHub"),"! If you encounter any bugs, have suggestions, or otherwise want to contribute, feel free to check out the repo."))},z=a(67),H=function(e){var t=e.value,a=e.onChange,n=e.text;e.defaultValue;return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{id:n,type:"checkbox",checked:t,onChange:function(e){return a(e.currentTarget.checked)}}),r.a.createElement("label",{htmlFor:n},n))},Q=a(110),J=function(e){var t=e.value,a=e.onChange,n=e.text;e.defaultValue;return r.a.createElement(r.a.Fragment,null,n,r.a.createElement(Q.ChromePicker,{color:t,onChange:function(e){return a(e.rgb)}}))},q=function(e){switch(e.type){case"boolean":return r.a.createElement(H,e);case"color":return r.a.createElement(J,e)}},K=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(),a=Object(s.a)(t,2),c=a[0],i=a[1],o=Object(n.useState)(R.RAINBOW_SPIRAL),d=Object(s.a)(o,2),h=d[0],m=d[1],f=Object(n.useState)(),g=Object(s.a)(f,2),b=g[0],p=g[1],E=Object(n.useState)(),w=Object(s.a)(E,2),x=w[0],j=w[1],O=Object(n.useState)({width:0,height:0}),N=Object(s.a)(O,2),S=N[0],I=N[1],C=Object(n.useState)(),A=Object(s.a)(C,2),P=A[0],M=A[1],B=Object(n.useState)(""),D=Object(s.a)(B,2),T=D[0],V=D[1],W=Object(n.useState)(!1),F=Object(s.a)(W,2),_=F[0],G=F[1];Object(n.useEffect)((function(){var e=L(h);p(e);var t={};e.getEncodeForm().forEach((function(e){x&&null!=x[e.key]?t[e.key]=x[e.key]:t[e.key]=e.defaultValue})),j(t)}),[h]);var U=Object(n.useCallback)((function(e){var t,a=null===(t=e.currentTarget.files)||void 0===t?void 0:t.item(0);if(a){i(void 0),V(""),I({width:0,height:0});var n=new FileReader;n.addEventListener("load",(function(){n.result&&"object"===typeof n.result&&i({type:a.type,data:new Uint8Array(n.result)})})),n.readAsArrayBuffer(a)}}),[]),Y=Object(n.useCallback)(Object(u.a)(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null===(a=e.current)||void 0===a?void 0:a.getContext("2d"),c&&n&&b){t.next=3;break}return t.abrupt("return");case 3:return G(!0),t.next=6,b.encode(c,{setCanvasProps:function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Promise((function(e){M((function(){return e}))})),I(t),e.next=4,a;case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),form:x});case 6:k(n,0,0,{red:86,green:105,blue:120,alpha:255}),k(n,1,0,{red:121,green:108,blue:h,alpha:255}),V(n.canvas.toDataURL()),G(!1);case 10:case"end":return t.stop()}}),t)}))),[c,h,b,x]);return Object(n.useEffect)((function(){P&&P()}),[S]),r.a.createElement("main",{className:"flex-center"},r.a.createElement("div",{className:"controls"},r.a.createElement("input",{type:"file",className:"row",onChange:U}),r.a.createElement("select",{className:"row",onChange:function(e){return m(parseInt(e.currentTarget.value,10))},value:h},r.a.createElement("option",{value:R.GRAY_SPIRAL},"Gray Spiral"),r.a.createElement("option",{value:R.RAINBOW_SPIRAL},"Rainbow Spiral")),x&&b&&b.getEncodeForm().map((function(e){return r.a.createElement("div",{key:e.key,className:"row"},r.a.createElement(q,Object.assign({},e,{value:x[e.key],onChange:function(t){return j((function(a){return Object(z.a)(Object(z.a)({},a),{},Object(y.a)({},e.key,t))}))}})))})),r.a.createElement("button",{className:"big",onClick:Y,disabled:!c},"Create ",r.a.createElement(v,{icon:"compact-disc"})),T&&r.a.createElement("a",{download:"vinyl.png",href:T},r.a.createElement("button",{className:"big"},"Save ",r.a.createElement(v,{icon:"image"}))),_&&r.a.createElement("div",{className:"big"},r.a.createElement(v,{icon:"spinner",className:"fa-pulse"})," Loading...")),r.a.createElement("div",null,r.a.createElement("canvas",Object.assign({},S,{ref:e}))))},X=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",null,r.a.createElement(T.b,{to:"/"},r.a.createElement("h1",null,"Vixyl")),r.a.createElement("nav",null,r.a.createElement(T.c,{exact:!0,to:"/"},"About"),r.a.createElement(T.c,{exact:!0,to:"/read"},"Read vinyl"),r.a.createElement(T.c,{exact:!0,to:"/create"},"Create vinyl"))),r.a.createElement(D,null),r.a.createElement("div",{className:"content"},r.a.createElement(V.d,null,r.a.createElement(V.b,{exact:!0,path:"/",component:Y}),r.a.createElement(V.b,{exact:!0,path:"/read",component:B}),r.a.createElement(V.b,{exact:!0,path:"/create",component:K}),r.a.createElement(V.a,{to:"/"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T.a,null,r.a.createElement(X,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[111,1,2]]]);
//# sourceMappingURL=main.47155e22.chunk.js.map